### ===================================
### IOT - Internet das Coisas
### ===================================
### INSTRUÇÕES:
### 1. Execute o LOGIN primeiro
### 2. Copie o token da resposta
### 3. Cole no arquivo http-client.env.json no campo "iotToken"
### 4. Execute as outras requisições
### ===================================

@baseUrl = {{baseUrl}}
@token = {{iotToken}}

###############################################
### 1. AUTENTICAÇÃO
###############################################

### Login como IOT
POST {{baseUrl}}/auth/login
Content-Type: application/json

{
  "team": "IOT",
  "secret": "iot-secret"
}

###

### Verificar meu perfil
GET {{baseUrl}}/auth/me
Authorization: Bearer {{token}}

###############################################
### 2. INGESTÃO DE MÉTRICAS (IOT)
###############################################

### Enviar métrica: temperatura (DHT22)
POST {{baseUrl}}/otel/v1/metrics
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "teamTag": "IOT",
  "timestamp": "2025-11-19T21:50:00Z",
  "payloadJson": "{\"metric\":\"temperature\",\"value\":25.5,\"sensor\":\"DHT22\",\"location\":\"sala-1\"}"
}

###

### Enviar métrica: umidade (DHT22)
POST {{baseUrl}}/otel/v1/metrics
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "teamTag": "IOT",
  "timestamp": "2025-11-19T21:51:00Z",
  "payloadJson": "{\"metric\":\"humidity\",\"value\":65.2,\"sensor\":\"DHT22\",\"location\":\"sala-1\"}"
}

###

### Enviar métrica: CO2 (MQ135)
POST {{baseUrl}}/otel/v1/metrics
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "teamTag": "IOT",
  "timestamp": "2025-11-19T21:52:00Z",
  "payloadJson": "{\"metric\":\"co2_ppm\",\"value\":850,\"sensor\":\"MQ135\",\"location\":\"sala-2\"}"
}

###

### Enviar métrica: luminosidade (LDR)
POST {{baseUrl}}/otel/v1/metrics
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "teamTag": "IOT",
  "timestamp": "2025-11-19T21:53:00Z",
  "payloadJson": "{\"metric\":\"light_lux\",\"value\":320,\"sensor\":\"LDR\",\"location\":\"sala-1\"}"
}

###

### Enviar métrica: movimento (PIR)
POST {{baseUrl}}/otel/v1/metrics
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "teamTag": "IOT",
  "timestamp": "2025-11-19T21:54:00Z",
  "payloadJson": "{\"metric\":\"motion_detected\",\"value\":1,\"sensor\":\"PIR\",\"location\":\"corredor\"}"
}

###

### Enviar métrica: pressão atmosférica (BMP180)
POST {{baseUrl}}/otel/v1/metrics
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "teamTag": "IOT",
  "timestamp": "2025-11-19T21:55:00Z",
  "payloadJson": "{\"metric\":\"pressure_hpa\",\"value\":1013.25,\"sensor\":\"BMP180\",\"location\":\"sala-1\"}"
}

###

### Enviar métrica: consumo de energia (SCT013)
POST {{baseUrl}}/otel/v1/metrics
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "teamTag": "IOT",
  "timestamp": "2025-11-19T21:56:00Z",
  "payloadJson": "{\"metric\":\"power_watts\",\"value\":125.5,\"sensor\":\"SCT013\",\"device\":\"ar-condicionado\"}"
}

###

### Enviar métrica: nível de água (HC-SR04)
POST {{baseUrl}}/otel/v1/metrics
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "teamTag": "IOT",
  "timestamp": "2025-11-19T21:57:00Z",
  "payloadJson": "{\"metric\":\"water_level_cm\",\"value\":45,\"sensor\":\"HC-SR04\",\"location\":\"reservatorio\"}"
}

###############################################
### 3. INGESTÃO DE TRACES (IOT)
###############################################

### Enviar trace: leitura de sensor
POST {{baseUrl}}/otel/v1/traces
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "teamTag": "IOT",
  "timestamp": "2025-11-19T21:58:00Z",
  "payloadJson": "{\"traceId\":\"iot-trace-001\",\"spanId\":\"span-sensor-read\",\"operation\":\"read_sensor\",\"sensor\":\"DHT22\",\"duration_ms\":50}"
}

###

### Enviar trace: envio de dados
POST {{baseUrl}}/otel/v1/traces
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "teamTag": "IOT",
  "timestamp": "2025-11-19T21:59:00Z",
  "payloadJson": "{\"traceId\":\"iot-trace-002\",\"spanId\":\"span-send-data\",\"operation\":\"send_to_cloud\",\"duration_ms\":120}"
}

###############################################
### 4. INGESTÃO DE LOGS (IOT)
###############################################

### Enviar log: sensor conectado
POST {{baseUrl}}/otel/v1/logs
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "teamTag": "IOT",
  "timestamp": "2025-11-19T22:00:00Z",
  "payloadJson": "{\"level\":\"INFO\",\"message\":\"Sensor DHT22 connected successfully\",\"device_id\":\"ESP32-001\"}"
}

###

### Enviar log: erro de leitura
POST {{baseUrl}}/otel/v1/logs
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "teamTag": "IOT",
  "timestamp": "2025-11-19T22:01:00Z",
  "payloadJson": "{\"level\":\"ERROR\",\"message\":\"Failed to read from MQ135 sensor\",\"device_id\":\"ESP32-002\",\"retry_count\":3}"
}

###

### Enviar log: bateria baixa
POST {{baseUrl}}/otel/v1/logs
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "teamTag": "IOT",
  "timestamp": "2025-11-19T22:02:00Z",
  "payloadJson": "{\"level\":\"WARNING\",\"message\":\"Low battery: 15% remaining\",\"device_id\":\"ESP32-003\"}"
}

###############################################
### 5. CONSULTA DE MÉTRICAS (IOT - vê só suas)
###############################################

### Consultar minhas métricas (paginado)
GET {{baseUrl}}/export/metrics?page=0&size=10
Authorization: Bearer {{token}}

###

### Consultar métricas com ordenação por timestamp (mais recentes)
GET {{baseUrl}}/export/metrics?page=0&size=10&sort=timestamp,desc
Authorization: Bearer {{token}}

###

### Consultar métricas - página 2
GET {{baseUrl}}/export/metrics?page=1&size=10
Authorization: Bearer {{token}}

###

### Consultar traces
GET {{baseUrl}}/export/traces?page=0&size=10
Authorization: Bearer {{token}}

###

### Consultar logs
GET {{baseUrl}}/export/logs?page=0&size=10
Authorization: Bearer {{token}}

###############################################
### 6. BATCH DE MÉTRICAS (Simular múltiplos sensores)
###############################################

### Temperatura - Leitura 1
POST {{baseUrl}}/otel/v1/metrics
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "teamTag": "IOT",
  "timestamp": "2025-11-19T22:05:00Z",
  "payloadJson": "{\"metric\":\"temperature\",\"value\":26.0,\"sensor\":\"DHT22\",\"location\":\"sala-1\"}"
}

###

### Temperatura - Leitura 2
POST {{baseUrl}}/otel/v1/metrics
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "teamTag": "IOT",
  "timestamp": "2025-11-19T22:10:00Z",
  "payloadJson": "{\"metric\":\"temperature\",\"value\":26.5,\"sensor\":\"DHT22\",\"location\":\"sala-1\"}"
}

###

### Temperatura - Leitura 3
POST {{baseUrl}}/otel/v1/metrics
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "teamTag": "IOT",
  "timestamp": "2025-11-19T22:15:00Z",
  "payloadJson": "{\"metric\":\"temperature\",\"value\":27.0,\"sensor\":\"DHT22\",\"location\":\"sala-1\"}"
}

###############################################
### 7. HEALTH CHECKS
###############################################

### Health check da aplicação
GET {{baseUrl}}/actuator/health

###

### Informações da aplicação
GET {{baseUrl}}/actuator/info

